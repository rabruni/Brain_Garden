{"event_type": "LLM_CALL", "submission_id": "msg_01NSxQe8Sxw9Ejkv32WSh4zR", "decision": "COMPLETED", "reason": "LLM completion via anthropic", "prompts_used": ["PRM-BRAIN-001"], "metadata": {"prompt_text": "You are the Brain advisory module for a Control Plane governance system.\n\nAnalyze the user's query against the current system context and produce structured advice.\n\nSystem Context:\n{\n  \"packages\": [],\n  \"health\": {\n    \"error\": \"/usr/local/Cellar/python@3.14/3.14.2/Frameworks/Python.framework/Versions/3.14/Resources/Python.app/Contents/MacOS/Python: can't open file '/private/var/folders/gf/3ljb_fbn6ksf8tfghxr6nwlr0000gn/T/pytest-of-raymondbruni/pytest-236/test_error_before_routing_has_0/scripts/trace.py': [Errno 2] No such file or directory\\n\"\n  },\n  \"session\": {\n    \"session_id\": \"SES-20260206-944ce051\",\n    \"tier\": \"ho1\",\n    \"session_path\": \"/private/var/folders/gf/3ljb_fbn6ksf8tfghxr6nwlr0000gn/T/pytest-of-raymondbruni/pytest-236/test_error_before_routing_has_0/planes/ho1/sessions/SES-20260206-944ce051\",\n    \"ledger_path\": \"/private/var/folders/gf/3ljb_fbn6ksf8tfghxr6nwlr0000gn/T/pytest-of-raymondbruni/pytest-236/test_error_before_routing_has_0/planes/ho1/sessions/SES-20260206-944ce051/ledger\",\n    \"exec_ledger_path\": \"/private/var/folders/gf/3ljb_fbn6ksf8tfghxr6nwlr0000gn/T/pytest-of-raymondbruni/pytest-236/test_error_before_routing_has_0/planes/ho1/sessions/SES-20260206-944ce051/ledger/exec.jsonl\",\n    \"evidence_ledger_path\": \"/private/var/folders/gf/3ljb_fbn6ksf8tfghxr6nwlr0000gn/T/pytest-of-raymondbruni/pytest-236/test_error_before_routing_has_0/planes/ho1/sessions/SES-20260206-944ce051/ledger/evidence.jsonl\"\n  },\n  \"session_ledger\": [\n    {\n      \"turn\": 1,\n      \"type\": \"user_query\",\n      \"content\": \"list packages\",\n      \"timestamp\": \"2026-02-06T15:42:27.034590+00:00\",\n      \"status\": null\n    }\n  ],\n  \"llm_calls\": [],\n  \"ledger_directory\": \"/private/var/folders/gf/3ljb_fbn6ksf8tfghxr6nwlr0000gn/T/pytest-of-raymondbruni/pytest-236/test_error_before_routing_has_0/ledger\",\n  \"available_ledgers\": {\n    \"directory\": \"/private/var/folders/gf/3ljb_fbn6ksf8tfghxr6nwlr0000gn/T/pytest-of-raymondbruni/pytest-236/test_error_before_routing_has_0/ledger\",\n    \"governance\": [],\n    \"packages\": [],\n    \"kernel\": [],\n    \"llm\": null,\n    \"index\": null\n  },\n  \"todays_governance\": [],\n  \"package_events\": [],\n  \"kernel_events\": [],\n  \"recent_sessions\": [\n    \"SES-20260206-944ce051\"\n  ]\n}\n\nUser Query: list packages\n\nBased on the system context, determine:\n1. What is the user's intent?\n2. Which handler should process this? Choose from: list_installed, list_frameworks, list_specs, explain, check_health, show_ledger, show_session_ledger, read_file, validate_document, summarize, general\n3. Should this use tools_first (deterministic, data lookup) or llm_assisted (needs LLM synthesis)?\n4. What is the recommended next step?\n\nRespond with valid JSON only:\n{\n  \"intent\": \"brief description of user intent\",\n  \"confidence\": 0.0-1.0,\n  \"suggested_handler\": \"handler_name from the list above\",\n  \"mode\": \"tools_first or llm_assisted\",\n  \"proposed_next_step\": \"1-2 sentence recommendation for the user\"\n}", "response_text": "```json\n{\n  \"intent\": \"User wants to see a list of installed packages in the system\",\n  \"confidence\": 0.95,\n  \"suggested_handler\": \"list_installed\",\n  \"mode\": \"tools_first\",\n  \"proposed_next_step\": \"Display the current list of installed packages, though the system context shows no packages are currently installed.\"\n}\n```", "prompt_hash": "sha256:f1ab1c02ed394fe2fbc40ceb6f3cb0aee1e7c078ee461e10283b02f7a61a46db", "response_hash": "sha256:d00744b4090c33d9046dcccd8bc1c73ddfb29d37fe358ecbe12a0f7c25b54884", "model": "claude-sonnet-4-20250514", "usage": {"input_tokens": 1140, "output_tokens": 91}, "cached": false, "duration_ms": 2812, "provider_id": "anthropic", "prompt_pack_id": "PRM-BRAIN-001"}, "id": "LED-8f5d12b8", "timestamp": "2026-02-06T15:42:30.042269+00:00", "previous_hash": "3c76411bf4aab9bc84c378e820880de26d1a7d5fb1097920f704a8d62a78abab", "entry_hash": "56d08163e9f4167c2f5d2ef9bc8d8ce7cc4d4c326396975cb4018db2d61f9259"}
{"event_type": "LLM_CALL", "submission_id": "mock-9bd8cbafb8ad", "decision": "COMPLETED", "reason": "LLM completion via mock", "prompts_used": ["PRM-ROUTER-001"], "metadata": {"prompt_text": "Classify this Control Plane admin query.\n\nQuery: List packages\n\nWhat kind of request is this?\n- list_packages: Show installed packages\n- list_frameworks: Show frameworks\n- list_specs: Show specifications\n- explain_artifact: Explain FMWK-XXX, SPEC-XXX, or PKG-XXX\n- health_check: System status or verification\n- show_ledger: Governance/audit logs\n- show_session: Current session info\n- read_file: Read a specific file\n- validate: Check compliance\n- summarize: Summary or comparison\n- general: Doesn't fit other categories\n\nIf the query mentions an artifact (FMWK-XXX, SPEC-XXX, PKG-XXX), extract it.\nIf the query mentions a file path, extract it.\n\nRespond with valid JSON only:\n{\n  \"intent\": \"the_intent\",\n  \"artifact_id\": \"FMWK-XXX | null\",\n  \"file_path\": \"path/to/file | null\",\n  \"confidence\": 0.0-1.0,\n  \"reasoning\": \"1 sentence\"\n}", "response_text": "This is a mock explanation of the requested artifact.", "prompt_hash": "sha256:cce4a50b5f386d8f6d5ee211d5c0063b7c757efefe8fd3332bca1ddb7f78d2b1", "response_hash": "sha256:39018843e4367e1149c1a443fc4ba9d0b4570ec43ff80e089fad2ce49134ca63", "model": "mock-model", "usage": {"input_tokens": 113, "output_tokens": 9}, "cached": false, "duration_ms": 0, "provider_id": "mock", "prompt_pack_id": "PRM-ROUTER-001"}, "id": "LED-c2305376", "timestamp": "2026-02-06T15:42:30.871574+00:00", "previous_hash": "3c76411bf4aab9bc84c378e820880de26d1a7d5fb1097920f704a8d62a78abab", "entry_hash": "26c229820130969dfbe5043e526cafb712678e4fe42772877e4951b05cd0475b"}
{"event_type": "LLM_CALL", "submission_id": "mock-782b08bc3e1b", "decision": "COMPLETED", "reason": "LLM completion via mock", "prompts_used": ["PRM-ROUTER-001"], "metadata": {"prompt_text": "Classify this Control Plane admin query.\n\nQuery: Validate document\n\nWhat kind of request is this?\n- list_packages: Show installed packages\n- list_frameworks: Show frameworks\n- list_specs: Show specifications\n- explain_artifact: Explain FMWK-XXX, SPEC-XXX, or PKG-XXX\n- health_check: System status or verification\n- show_ledger: Governance/audit logs\n- show_session: Current session info\n- read_file: Read a specific file\n- validate: Check compliance\n- summarize: Summary or comparison\n- general: Doesn't fit other categories\n\nIf the query mentions an artifact (FMWK-XXX, SPEC-XXX, PKG-XXX), extract it.\nIf the query mentions a file path, extract it.\n\nRespond with valid JSON only:\n{\n  \"intent\": \"the_intent\",\n  \"artifact_id\": \"FMWK-XXX | null\",\n  \"file_path\": \"path/to/file | null\",\n  \"confidence\": 0.0-1.0,\n  \"reasoning\": \"1 sentence\"\n}", "response_text": "This is a mock explanation of the requested artifact.", "prompt_hash": "sha256:335cadaa81eef8a4f1c607e02757954aa6e538a1ee40cf52c2fe05337762e656", "response_hash": "sha256:39018843e4367e1149c1a443fc4ba9d0b4570ec43ff80e089fad2ce49134ca63", "model": "mock-model", "usage": {"input_tokens": 113, "output_tokens": 9}, "cached": false, "duration_ms": 0, "provider_id": "mock", "prompt_pack_id": "PRM-ROUTER-001"}, "id": "LED-1b50ba85", "timestamp": "2026-02-06T15:42:30.898949+00:00", "previous_hash": "3c76411bf4aab9bc84c378e820880de26d1a7d5fb1097920f704a8d62a78abab", "entry_hash": "a324195ade9b25cdc8cdd7dda086ebb4fa9aad6bbebbdaaab84259af836c5050"}
{"event_type": "LLM_CALL", "submission_id": "mock-367c6273d814", "decision": "COMPLETED", "reason": "LLM completion via mock", "prompts_used": ["PRM-ROUTER-001"], "metadata": {"prompt_text": "Classify this Control Plane admin query.\n\nQuery: Validate document\n\nWhat kind of request is this?\n- list_packages: Show installed packages\n- list_frameworks: Show frameworks\n- list_specs: Show specifications\n- explain_artifact: Explain FMWK-XXX, SPEC-XXX, or PKG-XXX\n- health_check: System status or verification\n- show_ledger: Governance/audit logs\n- show_session: Current session info\n- read_file: Read a specific file\n- validate: Check compliance\n- summarize: Summary or comparison\n- general: Doesn't fit other categories\n\nIf the query mentions an artifact (FMWK-XXX, SPEC-XXX, PKG-XXX), extract it.\nIf the query mentions a file path, extract it.\n\nRespond with valid JSON only:\n{\n  \"intent\": \"the_intent\",\n  \"artifact_id\": \"FMWK-XXX | null\",\n  \"file_path\": \"path/to/file | null\",\n  \"confidence\": 0.0-1.0,\n  \"reasoning\": \"1 sentence\"\n}", "response_text": "This is a mock explanation of the requested artifact.", "prompt_hash": "sha256:335cadaa81eef8a4f1c607e02757954aa6e538a1ee40cf52c2fe05337762e656", "response_hash": "sha256:39018843e4367e1149c1a443fc4ba9d0b4570ec43ff80e089fad2ce49134ca63", "model": "mock-model", "usage": {"input_tokens": 113, "output_tokens": 9}, "cached": false, "duration_ms": 0, "provider_id": "mock", "prompt_pack_id": "PRM-ROUTER-001"}, "id": "LED-6441afac", "timestamp": "2026-02-06T15:42:30.916658+00:00", "previous_hash": "3c76411bf4aab9bc84c378e820880de26d1a7d5fb1097920f704a8d62a78abab", "entry_hash": "49631c21ead5b41aaf79e7ff57a9770deff1e2a5a9d4398401d95a4f54ff7096"}
{"event_type": "LLM_CALL", "submission_id": "mock-2990e81731ec", "decision": "COMPLETED", "reason": "LLM completion via mock", "prompts_used": ["PRM-ROUTER-001"], "metadata": {"prompt_text": "Classify this Control Plane admin query.\n\nQuery: Validate document\n\nWhat kind of request is this?\n- list_packages: Show installed packages\n- list_frameworks: Show frameworks\n- list_specs: Show specifications\n- explain_artifact: Explain FMWK-XXX, SPEC-XXX, or PKG-XXX\n- health_check: System status or verification\n- show_ledger: Governance/audit logs\n- show_session: Current session info\n- read_file: Read a specific file\n- validate: Check compliance\n- summarize: Summary or comparison\n- general: Doesn't fit other categories\n\nIf the query mentions an artifact (FMWK-XXX, SPEC-XXX, PKG-XXX), extract it.\nIf the query mentions a file path, extract it.\n\nRespond with valid JSON only:\n{\n  \"intent\": \"the_intent\",\n  \"artifact_id\": \"FMWK-XXX | null\",\n  \"file_path\": \"path/to/file | null\",\n  \"confidence\": 0.0-1.0,\n  \"reasoning\": \"1 sentence\"\n}", "response_text": "This is a mock explanation of the requested artifact.", "prompt_hash": "sha256:335cadaa81eef8a4f1c607e02757954aa6e538a1ee40cf52c2fe05337762e656", "response_hash": "sha256:39018843e4367e1149c1a443fc4ba9d0b4570ec43ff80e089fad2ce49134ca63", "model": "mock-model", "usage": {"input_tokens": 113, "output_tokens": 9}, "cached": false, "duration_ms": 0, "provider_id": "mock", "prompt_pack_id": "PRM-ROUTER-001"}, "id": "LED-82f22233", "timestamp": "2026-02-06T15:42:30.935398+00:00", "previous_hash": "3c76411bf4aab9bc84c378e820880de26d1a7d5fb1097920f704a8d62a78abab", "entry_hash": "3d2f89dec651af3727361b083232bf020b2389b22a520942f529388607770645"}
{"event_type": "LLM_CALL", "submission_id": "mock-8974f75b54be", "decision": "COMPLETED", "reason": "LLM completion via mock", "prompts_used": ["PRM-ROUTER-001"], "metadata": {"prompt_text": "Classify this Control Plane admin query.\n\nQuery: List packages\n\nWhat kind of request is this?\n- list_packages: Show installed packages\n- list_frameworks: Show frameworks\n- list_specs: Show specifications\n- explain_artifact: Explain FMWK-XXX, SPEC-XXX, or PKG-XXX\n- health_check: System status or verification\n- show_ledger: Governance/audit logs\n- show_session: Current session info\n- read_file: Read a specific file\n- validate: Check compliance\n- summarize: Summary or comparison\n- general: Doesn't fit other categories\n\nIf the query mentions an artifact (FMWK-XXX, SPEC-XXX, PKG-XXX), extract it.\nIf the query mentions a file path, extract it.\n\nRespond with valid JSON only:\n{\n  \"intent\": \"the_intent\",\n  \"artifact_id\": \"FMWK-XXX | null\",\n  \"file_path\": \"path/to/file | null\",\n  \"confidence\": 0.0-1.0,\n  \"reasoning\": \"1 sentence\"\n}", "response_text": "This is a mock explanation of the requested artifact.", "prompt_hash": "sha256:cce4a50b5f386d8f6d5ee211d5c0063b7c757efefe8fd3332bca1ddb7f78d2b1", "response_hash": "sha256:39018843e4367e1149c1a443fc4ba9d0b4570ec43ff80e089fad2ce49134ca63", "model": "mock-model", "usage": {"input_tokens": 113, "output_tokens": 9}, "cached": false, "duration_ms": 0, "provider_id": "mock", "prompt_pack_id": "PRM-ROUTER-001"}, "id": "LED-d594aeeb", "timestamp": "2026-02-06T15:42:30.958685+00:00", "previous_hash": "3c76411bf4aab9bc84c378e820880de26d1a7d5fb1097920f704a8d62a78abab", "entry_hash": "e87b764e4ce626780fb4c74916164e3ba657841796f342c39b1309c25cb1a6f1"}
{"event_type": "LLM_CALL", "submission_id": "mock-3edc4de57fa6", "decision": "COMPLETED", "reason": "LLM completion via mock", "prompts_used": ["PRM-ROUTER-001"], "metadata": {"prompt_text": "Classify this Control Plane admin query.\n\nQuery: List packages\n\nWhat kind of request is this?\n- list_packages: Show installed packages\n- list_frameworks: Show frameworks\n- list_specs: Show specifications\n- explain_artifact: Explain FMWK-XXX, SPEC-XXX, or PKG-XXX\n- health_check: System status or verification\n- show_ledger: Governance/audit logs\n- show_session: Current session info\n- read_file: Read a specific file\n- validate: Check compliance\n- summarize: Summary or comparison\n- general: Doesn't fit other categories\n\nIf the query mentions an artifact (FMWK-XXX, SPEC-XXX, PKG-XXX), extract it.\nIf the query mentions a file path, extract it.\n\nRespond with valid JSON only:\n{\n  \"intent\": \"the_intent\",\n  \"artifact_id\": \"FMWK-XXX | null\",\n  \"file_path\": \"path/to/file | null\",\n  \"confidence\": 0.0-1.0,\n  \"reasoning\": \"1 sentence\"\n}", "response_text": "This is a mock explanation of the requested artifact.", "prompt_hash": "sha256:cce4a50b5f386d8f6d5ee211d5c0063b7c757efefe8fd3332bca1ddb7f78d2b1", "response_hash": "sha256:39018843e4367e1149c1a443fc4ba9d0b4570ec43ff80e089fad2ce49134ca63", "model": "mock-model", "usage": {"input_tokens": 113, "output_tokens": 9}, "cached": false, "duration_ms": 0, "provider_id": "mock", "prompt_pack_id": "PRM-ROUTER-001"}, "id": "LED-50703db4", "timestamp": "2026-02-06T15:42:30.985338+00:00", "previous_hash": "3c76411bf4aab9bc84c378e820880de26d1a7d5fb1097920f704a8d62a78abab", "entry_hash": "9e2aa356b60a1232f075ae1a6275b1ca2b7c130aa8526aeec2867d3d81170a66"}
