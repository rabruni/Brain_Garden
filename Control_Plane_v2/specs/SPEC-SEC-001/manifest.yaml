spec_id: SPEC-SEC-001
title: "Security & Auth"
framework_id: FMWK-ATT-001
status: active
version: 1.0.0
plane_id: ho3

assets:
  - lib/auth.py
  - lib/authz.py
  - lib/pristine.py
  - lib/install_auth.py
  - scripts/cp_init_auth.py
  - scripts/seal_guard.py
  - tests/test_auth.py
  - tests/test_authz.py
  - tests/test_pristine.py

interfaces:
  - name: authenticate
    description: Authenticate request with configured provider
  - name: authorize
    description: Check role-based authorization
  - name: enforce_pristine
    description: Enforce write boundaries for pristine directories
  - name: init_auth_secrets
    description: Initialize external auth secrets

invariants:
  - "Authentication MUST fail-closed on invalid credentials"
  - "Authorization MUST fail-closed on missing role"
  - "Pristine enforcement MUST block all writes outside boundary"
  - "Secrets MUST NOT be logged or exposed"

acceptance:
  tests:
    - "pytest tests/test_auth.py"
    - "pytest tests/test_authz.py"
    - "pytest tests/test_pristine.py"
  checks:
    - "python3 -c 'from lib.auth import get_auth_provider; print(get_auth_provider)'"

non_goals:
  - "This spec does NOT handle key rotation"
  - "This spec does NOT handle SSO integration"
